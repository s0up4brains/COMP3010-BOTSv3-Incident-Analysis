# COMP3010-BOTSv3-Incident-Analysis

Investigation and report on security incidents using the Boss of the SOC v3 (BOTSv3) dataset within Splunk





##### Introduction



A Security Operations Centre (SOC) monitors, detects, analyses and responds to cybersecurity threats. The SOC defends their respective organisations from malicious activity, protecting critical systems, data and infrastructures allowing for early threat detection, resulting in effective response to incidents. SOC's use Security Information and Event Management (SIEM) tools - such as Splunk to present and sort log data to view in real time.



The BOTSv3 exercise is a sample security dataset to enhance CTF cybersecurity skills. The exercise simulates an incident involving a fictitious brewing company, 'frothly'. The incident can be uncovered through a series of data logs including those generated by network, endpoint, email, and AWS cloud service.



Using Splunk, the BOTSv3 logs can be investigated to uncover the events of the incident. The objectives of this investigation are primarily to answer the AWS and endpoint focused 200-level questions, uncover the events of the incident and produce a full incident report that details a strategy for mitigating risk in the future. The scope of the investigation has been limited to answering only the AWS and endpoint related 200-level questions. No investigation into specific malware or malware structures (i.e. malware reverse engineering) will take place in the investigation. 



The following assumptions have been made regarding the components of the investigation:



* The logs are accurate, complete and trustworthy
* Timestamps are properly formatted and accurate
* The dataset contains evidence of malicious activity



##### SOC Roles

SOC Structures



SOC Tiers

Tier 1

Tier 2

Tier 3

Link to Botsv3



SOC Responsibilities





SOC Analyst Method

\*One small paragraph here about investigation workflow\*

-Security Alert

-Supporting Evidence

-Analysis

-Conclusion

-Next Steps



##### Incident Handling Reflection



Incident handling methodology

-prevention

-detection

-response

-recovery





##### Installation \& Data Preparation



Linux

splunk installation

dataset ingestion \& validation

tools used

Justify Decisions in context of SOC infrastructure

Evidence



##### AWS endpoint events



TEMPLATE

-Detailed Explanation with SOC Relevance

-Question

-Query

-Timestamp

-Screenshot

-Dashboards

-Answer

-Threat Intel Lookup





Question 1. IAM users that accessed an AWS service

-Detailed Explanation



Query: index=botsv3 sourcetype="aws:cloudtrail" userIdentity.type=IAMUser

| stats values(userIdentity.userName) as users

-Timestamp

-Screenshot

Answer: bstoll,btun,splunk\_access,web\_admin

-Threat Intel Lookup







###### (IOC) Indicators of Compromise

###### 

###### Detection Methodology



###### Chronology of Events



TIMESTAMP HERE user 'bstoll' (Bud) logged in without Multi Factor Authenication



TIMESTAMP HERE S3 Bucket 'frothlywebcode' was made publicly accessible using (COMMAND HERE)



TIMESTAMP HERE Text file 'OPEN\_BUCKET\_PLEAE\_FIX.txt' was uploaded to the open bucket



TIMESTAMP HERE S3 Bucket 'frothlywebcode' was made private again



8/20/18 2:04:02:640 PM 'aws:cloudwatch:guardduty' caught extrernal known malicious IP probing an Open Port (SSH port 22 on an EC2 Instance i-0cc93bade2b3cba63 was reachable). Origninating from IP: 122.122.243.11 , Location: Beijing, China , ISP: China Telecom , Threat list: Proofpoint





##### Conclusion



Findings

Key Lessons

SOC strategy implications

Improvements to be made to detection and response



References (IEEE style)



SPLUNK (SIEM USED)

https://www.splunk.com/en\_us/download/splunk-enterprise.html?utm\_campaign=google\_emea\_tier1\_en\_search\_brand\&utm\_source=google\&utm\_medium=cpc\&utm\_content=Splunk\_Enterprise\_Demo\_v2\&utm\_term=splunk\&device=c\&\_bt=721259171719\&\_bm=e\&\_bn=g\&gad\_source=1\&gad\_campaignid=765600233\&gbraid=0AAAAAD8kDz1X9ahqgz6BumqBsPCb0ce83\&gclid=Cj0KCQiApL7KBhC7ARIsAD2Xq3CJZZIX32Ww9mVqqIU427vlx5Rc49U7OHMh2E52hSQw3ffTY0t8UAAaAv8xEALw\_wcB





UBUNTU LINUX 24.04.3 (VM ISO USED)

https://ubuntu.com/download/desktop





BOTSv3



AWS Cloudtraildocumentation



AWS GuardDuty



NIST incident response lifecycle



